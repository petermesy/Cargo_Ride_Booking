{"ast":null,"code":"var _jsxFileName = \"D:\\\\project\\\\cargo-booking-app\\\\frontend\\\\src\\\\pages\\\\DriverDashboard.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useContext } from 'react';\nimport MapComponent from '../components/MapComponent';\nimport CardComponent from '../components/CardComponent';\nimport socket from '../services/socket';\nimport api from '../services/api';\nimport { AuthContext } from '../context/AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DriverDashboard = () => {\n  _s();\n  const [status, setStatus] = useState('inactive');\n  const [currentLocation, setCurrentLocation] = useState();\n  const [booking, setBooking] = useState(null);\n  const {\n    user\n  } = useContext(AuthContext);\n  useEffect(() => {\n    // Socket.IO setup\n    socket.on('connect', () => console.log('Socket.IO connected'));\n    socket.on('connect_error', error => console.error('Socket.IO connection error:', error));\n    socket.on('driverStatusUpdate', data => {\n      if (data.driverId === (user === null || user === void 0 ? void 0 : user.id)) {\n        setStatus(data.status);\n      }\n    });\n\n    // Fetch current booking\n    const fetchBooking = async () => {\n      try {\n        const {\n          data\n        } = await api.get('/bookings/current', {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem('token')}`\n          }\n        });\n        setBooking(data);\n      } catch (error) {\n        console.error('Error fetching booking:', error);\n      }\n    };\n    fetchBooking();\n\n    // Get driver location\n    if (navigator.geolocation) {\n      const watchId = navigator.geolocation.watchPosition(position => {\n        const location = {\n          latitude: position.coords.latitude,\n          longitude: position.coords.longitude\n        };\n        setCurrentLocation(location);\n        socket.emit('driverLocationUpdate', {\n          driverId: user === null || user === void 0 ? void 0 : user.id,\n          location\n        });\n      }, error => {\n        console.error('Error getting driver location:', error);\n      });\n      return () => navigator.geolocation.clearWatch(watchId);\n    }\n    return () => {\n      socket.off('connect');\n      socket.off('connect_error');\n      socket.off('driverStatusUpdate');\n    };\n  }, [user]);\n  const toggleStatus = async () => {\n    const newStatus = status === 'active' ? 'inactive' : 'active';\n    try {\n      await api.put('/vehicles/status', {\n        status: newStatus\n      }, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      socket.emit('driverStatusUpdate', {\n        driverId: user === null || user === void 0 ? void 0 : user.id,\n        status: newStatus\n      });\n      setStatus(newStatus);\n    } catch (error) {\n      console.error('Error updating status:', error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container mx-auto p-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-2xl font-bold mb-4\",\n      children: \"Driver Dashboard\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 lg:grid-cols-3 gap-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lg:col-span-2\",\n        children: /*#__PURE__*/_jsxDEV(MapComponent, {\n          isDriver: true,\n          driverId: user === null || user === void 0 ? void 0 : user.id,\n          vehicles: [],\n          employeeLocation: booking === null || booking === void 0 ? void 0 : booking.pickupLocation,\n          driverLocation: currentLocation\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(CardComponent, {\n          title: \"Driver Status\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Status: \", /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"font-medium\",\n                children: status\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 94,\n                columnNumber: 26\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: toggleStatus,\n              className: `px-4 py-2 rounded text-white ${status === 'active' ? 'bg-red-500 hover:bg-red-600' : 'bg-green-500 hover:bg-green-600'}`,\n              children: status === 'active' ? 'Go Offline' : 'Go Online'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 95,\n              columnNumber: 15\n            }, this), booking && /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"font-medium\",\n                children: \"Current Booking\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 103,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm\",\n                children: [\"User: \", booking.user.name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 104,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm\",\n                children: [\"Status: \", booking.status]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 105,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 5\n  }, this);\n};\n_s(DriverDashboard, \"h9DMROnUcTZ3nj5Wl95ShHEPVNA=\");\n_c = DriverDashboard;\nexport default DriverDashboard;\nvar _c;\n$RefreshReg$(_c, \"DriverDashboard\");","map":{"version":3,"names":["React","useEffect","useState","useContext","MapComponent","CardComponent","socket","api","AuthContext","jsxDEV","_jsxDEV","DriverDashboard","_s","status","setStatus","currentLocation","setCurrentLocation","booking","setBooking","user","on","console","log","error","data","driverId","id","fetchBooking","get","headers","Authorization","localStorage","getItem","navigator","geolocation","watchId","watchPosition","position","location","latitude","coords","longitude","emit","clearWatch","off","toggleStatus","newStatus","put","className","children","fileName","_jsxFileName","lineNumber","columnNumber","isDriver","vehicles","employeeLocation","pickupLocation","driverLocation","title","onClick","name","_c","$RefreshReg$"],"sources":["D:/project/cargo-booking-app/frontend/src/pages/DriverDashboard.tsx"],"sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\r\nimport MapComponent from '../components/MapComponent';\r\nimport CardComponent from '../components/CardComponent';\r\nimport socket from '../services/socket';\r\nimport api from '../services/api';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { Booking } from '../types.ts';\r\n\r\nconst DriverDashboard: React.FC = () => {\r\n  const [status, setStatus] = useState('inactive');\r\n  const [currentLocation, setCurrentLocation] = useState<{ latitude: number; longitude: number } | undefined>();\r\n  const [booking, setBooking] = useState<Booking | null>(null);\r\n  const { user } = useContext(AuthContext);\r\n\r\n  useEffect(() => {\r\n    // Socket.IO setup\r\n    socket.on('connect', () => console.log('Socket.IO connected'));\r\n    socket.on('connect_error', (error) => console.error('Socket.IO connection error:', error));\r\n    socket.on('driverStatusUpdate', (data) => {\r\n      if (data.driverId === user?.id) {\r\n        setStatus(data.status);\r\n      }\r\n    });\r\n\r\n    // Fetch current booking\r\n    const fetchBooking = async () => {\r\n      try {\r\n        const { data } = await api.get('/bookings/current', {\r\n          headers: { Authorization: `Bearer ${localStorage.getItem('token')}` },\r\n        });\r\n        setBooking(data);\r\n      } catch (error) {\r\n        console.error('Error fetching booking:', error);\r\n      }\r\n    };\r\n    fetchBooking();\r\n\r\n    // Get driver location\r\n    if (navigator.geolocation) {\r\n      const watchId = navigator.geolocation.watchPosition(\r\n        (position) => {\r\n          const location = {\r\n            latitude: position.coords.latitude,\r\n            longitude: position.coords.longitude,\r\n          };\r\n          setCurrentLocation(location);\r\n          socket.emit('driverLocationUpdate', { driverId: user?.id, location });\r\n        },\r\n        (error) => {\r\n          console.error('Error getting driver location:', error);\r\n        }\r\n      );\r\n      return () => navigator.geolocation.clearWatch(watchId);\r\n    }\r\n\r\n    return () => {\r\n      socket.off('connect');\r\n      socket.off('connect_error');\r\n      socket.off('driverStatusUpdate');\r\n    };\r\n  }, [user]);\r\n\r\n  const toggleStatus = async () => {\r\n    const newStatus = status === 'active' ? 'inactive' : 'active';\r\n    try {\r\n      await api.put(\r\n        '/vehicles/status',\r\n        { status: newStatus },\r\n        { headers: { Authorization: `Bearer ${localStorage.getItem('token')}` } }\r\n      );\r\n      socket.emit('driverStatusUpdate', { driverId: user?.id, status: newStatus });\r\n      setStatus(newStatus);\r\n    } catch (error) {\r\n      console.error('Error updating status:', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"container mx-auto p-4\">\r\n      <h1 className=\"text-2xl font-bold mb-4\">Driver Dashboard</h1>\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4\">\r\n        <div className=\"lg:col-span-2\">\r\n          <MapComponent\r\n            isDriver={true}\r\n            driverId={user?.id}\r\n            vehicles={[]}\r\n            employeeLocation={booking?.pickupLocation}\r\n            driverLocation={currentLocation}\r\n          />\r\n        </div>\r\n        <div>\r\n          <CardComponent title=\"Driver Status\">\r\n            <div className=\"flex flex-col space-y-2\">\r\n              <p>Status: <span className=\"font-medium\">{status}</span></p>\r\n              <button\r\n                onClick={toggleStatus}\r\n                className={`px-4 py-2 rounded text-white ${status === 'active' ? 'bg-red-500 hover:bg-red-600' : 'bg-green-500 hover:bg-green-600'}`}\r\n              >\r\n                {status === 'active' ? 'Go Offline' : 'Go Online'}\r\n              </button>\r\n              {booking && (\r\n                <div>\r\n                  <p className=\"font-medium\">Current Booking</p>\r\n                  <p className=\"text-sm\">User: {booking.user.name}</p>\r\n                  <p className=\"text-sm\">Status: {booking.status}</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </CardComponent>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DriverDashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}